(function(c){var e;"undefined"==typeof exports?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(e={},define(function(){return e})):e="undefined"!=typeof window?window:c:e=exports;(function(c){if(!f)var f=1E-6;if(!k)var k="undefined"!=typeof Float32Array?Float32Array:Array;if(!l)var l=Math.random;var e={setMatrixArrayType:function(a){k=a}};"undefined"!=typeof c&&(c.glMatrix=e);var s=Math.PI/180;e.toRadian=function(a){return a*s};var r={create:function(){var a=new k(2);return a[0]=
0,a[1]=0,a},clone:function(a){var b=new k(2);return b[0]=a[0],b[1]=a[1],b},fromValues:function(a,b){var d=new k(2);return d[0]=a,d[1]=b,d},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a},set:function(a,b,d){return a[0]=b,a[1]=d,a},add:function(a,b,d){return a[0]=b[0]+d[0],a[1]=b[1]+d[1],a},subtract:function(a,b,d){return a[0]=b[0]-d[0],a[1]=b[1]-d[1],a}};r.sub=r.subtract;r.multiply=function(a,b,d){return a[0]=b[0]*d[0],a[1]=b[1]*d[1],a};r.mul=r.multiply;r.divide=function(a,b,d){return a[0]=b[0]/
d[0],a[1]=b[1]/d[1],a};r.div=r.divide;r.min=function(a,b,d){return a[0]=Math.min(b[0],d[0]),a[1]=Math.min(b[1],d[1]),a};r.max=function(a,b,d){return a[0]=Math.max(b[0],d[0]),a[1]=Math.max(b[1],d[1]),a};r.scale=function(a,b,d){return a[0]=b[0]*d,a[1]=b[1]*d,a};r.scaleAndAdd=function(a,b,d,h){return a[0]=b[0]+d[0]*h,a[1]=b[1]+d[1]*h,a};r.distance=function(a,b){var d=b[0]-a[0],h=b[1]-a[1];return Math.sqrt(d*d+h*h)};r.dist=r.distance;r.squaredDistance=function(a,b){var d=b[0]-a[0],h=b[1]-a[1];return d*
d+h*h};r.sqrDist=r.squaredDistance;r.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};r.len=r.length;r.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};r.sqrLen=r.squaredLength;r.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a};r.normalize=function(a,b){var d=b[0],h=b[1],d=d*d+h*h;return 0<d&&(d=1/Math.sqrt(d),a[0]=b[0]*d,a[1]=b[1]*d),a};r.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};r.cross=function(a,b,d){b=b[0]*d[1]-b[1]*d[0];return a[0]=a[1]=0,a[2]=b,a};r.lerp=function(a,
b,d,h){var t=b[0];b=b[1];return a[0]=t+h*(d[0]-t),a[1]=b+h*(d[1]-b),a};r.random=function(a,b){b=b||1;var d=2*l()*Math.PI;return a[0]=Math.cos(d)*b,a[1]=Math.sin(d)*b,a};r.transformMat2=function(a,b,d){var h=b[0];b=b[1];return a[0]=d[0]*h+d[2]*b,a[1]=d[1]*h+d[3]*b,a};r.transformMat2d=function(a,b,d){var h=b[0];b=b[1];return a[0]=d[0]*h+d[2]*b+d[4],a[1]=d[1]*h+d[3]*b+d[5],a};r.transformMat3=function(a,b,d){var h=b[0];b=b[1];return a[0]=d[0]*h+d[3]*b+d[6],a[1]=d[1]*h+d[4]*b+d[7],a};r.transformMat4=function(a,
b,d){var h=b[0];b=b[1];return a[0]=d[0]*h+d[4]*b+d[12],a[1]=d[1]*h+d[5]*b+d[13],a};r.forEach=function(){var a=r.create();return function(b,d,h,t,Q,c){var g;d||(d=2);h||(h=0);for(t?g=Math.min(t*d+h,b.length):g=b.length;h<g;h+=d)a[0]=b[h],a[1]=b[h+1],Q(a,a,c),b[h]=a[0],b[h+1]=a[1];return b}}();r.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};"undefined"!=typeof c&&(c.vec2=r);var n={create:function(){var a=new k(3);return a[0]=0,a[1]=0,a[2]=0,a},clone:function(a){var b=new k(3);return b[0]=a[0],b[1]=
a[1],b[2]=a[2],b},fromValues:function(a,b,d){var h=new k(3);return h[0]=a,h[1]=b,h[2]=d,h},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a},set:function(a,b,d,h){return a[0]=b,a[1]=d,a[2]=h,a},add:function(a,b,d){return a[0]=b[0]+d[0],a[1]=b[1]+d[1],a[2]=b[2]+d[2],a},subtract:function(a,b,d){return a[0]=b[0]-d[0],a[1]=b[1]-d[1],a[2]=b[2]-d[2],a}};n.sub=n.subtract;n.multiply=function(a,b,d){return a[0]=b[0]*d[0],a[1]=b[1]*d[1],a[2]=b[2]*d[2],a};n.mul=n.multiply;n.divide=function(a,b,d){return a[0]=
b[0]/d[0],a[1]=b[1]/d[1],a[2]=b[2]/d[2],a};n.div=n.divide;n.min=function(a,b,d){return a[0]=Math.min(b[0],d[0]),a[1]=Math.min(b[1],d[1]),a[2]=Math.min(b[2],d[2]),a};n.max=function(a,b,d){return a[0]=Math.max(b[0],d[0]),a[1]=Math.max(b[1],d[1]),a[2]=Math.max(b[2],d[2]),a};n.scale=function(a,b,d){return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a};n.scaleAndAdd=function(a,b,d,h){return a[0]=b[0]+d[0]*h,a[1]=b[1]+d[1]*h,a[2]=b[2]+d[2]*h,a};n.distance=function(a,b){var d=b[0]-a[0],h=b[1]-a[1],t=b[2]-a[2];return Math.sqrt(d*
d+h*h+t*t)};n.dist=n.distance;n.squaredDistance=function(a,b){var d=b[0]-a[0],h=b[1]-a[1],t=b[2]-a[2];return d*d+h*h+t*t};n.sqrDist=n.squaredDistance;n.length=function(a){var b=a[0],d=a[1];a=a[2];return Math.sqrt(b*b+d*d+a*a)};n.len=n.length;n.squaredLength=function(a){var b=a[0],d=a[1];a=a[2];return b*b+d*d+a*a};n.sqrLen=n.squaredLength;n.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a};n.normalize=function(a,b){var d=b[0],h=b[1],t=b[2],d=d*d+h*h+t*t;return 0<d&&(d=1/Math.sqrt(d),
a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d),a};n.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};n.cross=function(a,b,d){var h=b[0],t=b[1];b=b[2];var c=d[0],H=d[1];d=d[2];return a[0]=t*d-b*H,a[1]=b*c-h*d,a[2]=h*H-t*c,a};n.lerp=function(a,b,d,h){var t=b[0],c=b[1];b=b[2];return a[0]=t+h*(d[0]-t),a[1]=c+h*(d[1]-c),a[2]=b+h*(d[2]-b),a};n.random=function(a,b){b=b||1;var d=2*l()*Math.PI,h=2*l()-1,t=Math.sqrt(1-h*h)*b;return a[0]=Math.cos(d)*t,a[1]=Math.sin(d)*t,a[2]=h*b,a};n.transformMat4=function(a,b,
d){var h=b[0],t=b[1];b=b[2];return a[0]=d[0]*h+d[4]*t+d[8]*b+d[12],a[1]=d[1]*h+d[5]*t+d[9]*b+d[13],a[2]=d[2]*h+d[6]*t+d[10]*b+d[14],a};n.transformMat3=function(a,b,d){var h=b[0],t=b[1];b=b[2];return a[0]=h*d[0]+t*d[3]+b*d[6],a[1]=h*d[1]+t*d[4]+b*d[7],a[2]=h*d[2]+t*d[5]+b*d[8],a};n.transformQuat=function(a,b,d){var h=b[0],t=b[1],c=b[2];b=d[0];var H=d[1],g=d[2];d=d[3];var f=d*h+H*c-g*t,k=d*t+g*h-b*c,e=d*c+b*t-H*h,h=-b*h-H*t-g*c;return a[0]=f*d+h*-b+k*-g-e*-H,a[1]=k*d+h*-H+e*-b-f*-g,a[2]=e*d+h*-g+f*
-H-k*-b,a};n.rotateX=function(a,b,d,h){var t=[],c=[];return t[0]=b[0]-d[0],t[1]=b[1]-d[1],t[2]=b[2]-d[2],c[0]=t[0],c[1]=t[1]*Math.cos(h)-t[2]*Math.sin(h),c[2]=t[1]*Math.sin(h)+t[2]*Math.cos(h),a[0]=c[0]+d[0],a[1]=c[1]+d[1],a[2]=c[2]+d[2],a};n.rotateY=function(a,b,d,h){var t=[],c=[];return t[0]=b[0]-d[0],t[1]=b[1]-d[1],t[2]=b[2]-d[2],c[0]=t[2]*Math.sin(h)+t[0]*Math.cos(h),c[1]=t[1],c[2]=t[2]*Math.cos(h)-t[0]*Math.sin(h),a[0]=c[0]+d[0],a[1]=c[1]+d[1],a[2]=c[2]+d[2],a};n.rotateZ=function(a,b,d,h){var t=
[],c=[];return t[0]=b[0]-d[0],t[1]=b[1]-d[1],t[2]=b[2]-d[2],c[0]=t[0]*Math.cos(h)-t[1]*Math.sin(h),c[1]=t[0]*Math.sin(h)+t[1]*Math.cos(h),c[2]=t[2],a[0]=c[0]+d[0],a[1]=c[1]+d[1],a[2]=c[2]+d[2],a};n.forEach=function(){var a=n.create();return function(b,d,h,t,c,H){var g;d||(d=3);h||(h=0);for(t?g=Math.min(t*d+h,b.length):g=b.length;h<g;h+=d)a[0]=b[h],a[1]=b[h+1],a[2]=b[h+2],c(a,a,H),b[h]=a[0],b[h+1]=a[1],b[h+2]=a[2];return b}}();n.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};"undefined"!=
typeof c&&(c.vec3=n);var p={create:function(){var a=new k(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a},clone:function(a){var b=new k(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},fromValues:function(a,b,d,h){var t=new k(4);return t[0]=a,t[1]=b,t[2]=d,t[3]=h,t},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a},set:function(a,b,d,h,t){return a[0]=b,a[1]=d,a[2]=h,a[3]=t,a},add:function(a,b,d){return a[0]=b[0]+d[0],a[1]=b[1]+d[1],a[2]=b[2]+d[2],a[3]=b[3]+d[3],a},subtract:function(a,
b,d){return a[0]=b[0]-d[0],a[1]=b[1]-d[1],a[2]=b[2]-d[2],a[3]=b[3]-d[3],a}};p.sub=p.subtract;p.multiply=function(a,b,d){return a[0]=b[0]*d[0],a[1]=b[1]*d[1],a[2]=b[2]*d[2],a[3]=b[3]*d[3],a};p.mul=p.multiply;p.divide=function(a,b,d){return a[0]=b[0]/d[0],a[1]=b[1]/d[1],a[2]=b[2]/d[2],a[3]=b[3]/d[3],a};p.div=p.divide;p.min=function(a,b,d){return a[0]=Math.min(b[0],d[0]),a[1]=Math.min(b[1],d[1]),a[2]=Math.min(b[2],d[2]),a[3]=Math.min(b[3],d[3]),a};p.max=function(a,b,d){return a[0]=Math.max(b[0],d[0]),
a[1]=Math.max(b[1],d[1]),a[2]=Math.max(b[2],d[2]),a[3]=Math.max(b[3],d[3]),a};p.scale=function(a,b,d){return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d,a};p.scaleAndAdd=function(a,b,d,h){return a[0]=b[0]+d[0]*h,a[1]=b[1]+d[1]*h,a[2]=b[2]+d[2]*h,a[3]=b[3]+d[3]*h,a};p.distance=function(a,b){var d=b[0]-a[0],h=b[1]-a[1],t=b[2]-a[2],c=b[3]-a[3];return Math.sqrt(d*d+h*h+t*t+c*c)};p.dist=p.distance;p.squaredDistance=function(a,b){var d=b[0]-a[0],h=b[1]-a[1],t=b[2]-a[2],c=b[3]-a[3];return d*d+h*h+t*
t+c*c};p.sqrDist=p.squaredDistance;p.length=function(a){var b=a[0],d=a[1],h=a[2];a=a[3];return Math.sqrt(b*b+d*d+h*h+a*a)};p.len=p.length;p.squaredLength=function(a){var b=a[0],d=a[1],h=a[2];a=a[3];return b*b+d*d+h*h+a*a};p.sqrLen=p.squaredLength;p.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=-b[3],a};p.normalize=function(a,b){var d=b[0],h=b[1],t=b[2],c=b[3],d=d*d+h*h+t*t+c*c;return 0<d&&(d=1/Math.sqrt(d),a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d),a};p.dot=function(a,b){return a[0]*
b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};p.lerp=function(a,b,d,h){var t=b[0],c=b[1],g=b[2];b=b[3];return a[0]=t+h*(d[0]-t),a[1]=c+h*(d[1]-c),a[2]=g+h*(d[2]-g),a[3]=b+h*(d[3]-b),a};p.random=function(a,b){return b=b||1,a[0]=l(),a[1]=l(),a[2]=l(),a[3]=l(),p.normalize(a,a),p.scale(a,a,b),a};p.transformMat4=function(a,b,d){var h=b[0],t=b[1],c=b[2];b=b[3];return a[0]=d[0]*h+d[4]*t+d[8]*c+d[12]*b,a[1]=d[1]*h+d[5]*t+d[9]*c+d[13]*b,a[2]=d[2]*h+d[6]*t+d[10]*c+d[14]*b,a[3]=d[3]*h+d[7]*t+d[11]*c+d[15]*b,a};p.transformQuat=
function(a,b,d){var h=b[0],t=b[1],c=b[2];b=d[0];var g=d[1],f=d[2];d=d[3];var k=d*h+g*c-f*t,e=d*t+f*h-b*c,l=d*c+b*t-g*h,h=-b*h-g*t-f*c;return a[0]=k*d+h*-b+e*-f-l*-g,a[1]=e*d+h*-g+l*-b-k*-f,a[2]=l*d+h*-f+k*-g-e*-b,a};p.forEach=function(){var a=p.create();return function(b,d,h,t,c,g){var f;d||(d=4);h||(h=0);for(t?f=Math.min(t*d+h,b.length):f=b.length;h<f;h+=d)a[0]=b[h],a[1]=b[h+1],a[2]=b[h+2],a[3]=b[h+3],c(a,a,g),b[h]=a[0],b[h+1]=a[1],b[h+2]=a[2],b[h+3]=a[3];return b}}();p.str=function(a){return"vec4("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!=typeof c&&(c.vec4=p);e={create:function(){var a=new k(4);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},clone:function(a){var b=new k(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a},identity:function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},transpose:function(a,b){if(a===b){var d=b[1];a[1]=b[2];a[2]=d}else a[0]=b[0],a[1]=b[2],a[2]=b[1],a[3]=b[3];return a},invert:function(a,b){var d=
b[0],h=b[1],t=b[2],c=b[3],g=d*c-t*h;return g?(g=1/g,a[0]=c*g,a[1]=-h*g,a[2]=-t*g,a[3]=d*g,a):null},adjoint:function(a,b){var d=b[0];return a[0]=b[3],a[1]=-b[1],a[2]=-b[2],a[3]=d,a},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},multiply:function(a,b,d){var h=b[0],t=b[1],c=b[2];b=b[3];var g=d[0],f=d[1],k=d[2];d=d[3];return a[0]=h*g+c*f,a[1]=t*g+b*f,a[2]=h*k+c*d,a[3]=t*k+b*d,a}};e.mul=e.multiply;e.rotate=function(a,b,d){var h=b[0],c=b[1],g=b[2];b=b[3];var f=Math.sin(d);d=Math.cos(d);return a[0]=
h*d+g*f,a[1]=c*d+b*f,a[2]=h*-f+g*d,a[3]=c*-f+b*d,a};e.scale=function(a,b,d){var h=b[1],c=b[2],g=b[3],f=d[0];d=d[1];return a[0]=b[0]*f,a[1]=h*f,a[2]=c*d,a[3]=g*d,a};e.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};e.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))};e.LDU=function(a,b,d,h){return a[2]=h[2]/h[0],d[0]=h[0],d[1]=h[1],d[3]=h[3]-a[2]*d[1],[a,b,d]};"undefined"!=typeof c&&(c.mat2=e);e={create:function(){var a=new k(6);
return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},clone:function(a){var b=new k(6);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a},identity:function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},invert:function(a,b){var d=b[0],h=b[1],c=b[2],g=b[3],f=b[4],k=b[5],e=d*g-h*c;return e?(e=1/e,a[0]=g*e,a[1]=-h*e,a[2]=-c*e,a[3]=d*e,a[4]=(c*k-g*f)*e,a[5]=(h*f-d*k)*e,a):null},determinant:function(a){return a[0]*
a[3]-a[1]*a[2]},multiply:function(a,b,d){var h=b[0],c=b[1],g=b[2],f=b[3],k=b[4];b=b[5];var e=d[0],l=d[1],A=d[2],u=d[3],m=d[4];d=d[5];return a[0]=h*e+g*l,a[1]=c*e+f*l,a[2]=h*A+g*u,a[3]=c*A+f*u,a[4]=h*m+g*d+k,a[5]=c*m+f*d+b,a}};e.mul=e.multiply;e.rotate=function(a,b,d){var h=b[0],c=b[1],g=b[2],f=b[3],k=b[4];b=b[5];var e=Math.sin(d);d=Math.cos(d);return a[0]=h*d+g*e,a[1]=c*d+f*e,a[2]=h*-e+g*d,a[3]=c*-e+f*d,a[4]=k,a[5]=b,a};e.scale=function(a,b,d){var h=b[1],c=b[2],g=b[3],f=b[4],k=b[5],e=d[0];d=d[1];
return a[0]=b[0]*e,a[1]=h*e,a[2]=c*d,a[3]=g*d,a[4]=f,a[5]=k,a};e.translate=function(a,b,d){var h=b[0],c=b[1],g=b[2],f=b[3],k=b[4];b=b[5];var e=d[0];d=d[1];return a[0]=h,a[1]=c,a[2]=g,a[3]=f,a[4]=h*e+g*d+k,a[5]=c*e+f*d+b,a};e.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};e.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};"undefined"!=typeof c&&(c.mat2d=e);var x={create:function(){var a=
new k(9);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},fromMat4:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[4],a[4]=b[5],a[5]=b[6],a[6]=b[8],a[7]=b[9],a[8]=b[10],a},clone:function(a){var b=new k(9);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a},identity:function(a){return a[0]=1,a[1]=0,a[2]=
0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},transpose:function(a,b){if(a===b){var d=b[1],h=b[2],c=b[5];a[1]=b[3];a[2]=b[6];a[3]=d;a[5]=b[7];a[6]=h;a[7]=c}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},invert:function(a,b){var d=b[0],h=b[1],c=b[2],g=b[3],f=b[4],k=b[5],e=b[6],l=b[7],A=b[8],u=A*f-k*l,m=-A*g+k*e,v=l*g-f*e,n=d*u+h*m+c*v;return n?(n=1/n,a[0]=u*n,a[1]=(-A*h+c*l)*n,a[2]=(k*h-c*f)*n,a[3]=m*n,a[4]=(A*d-c*e)*n,a[5]=(-k*d+c*g)*n,a[6]=
v*n,a[7]=(-l*d+h*e)*n,a[8]=(f*d-h*g)*n,a):null},adjoint:function(a,b){var d=b[0],h=b[1],c=b[2],g=b[3],f=b[4],k=b[5],e=b[6],l=b[7],A=b[8];return a[0]=f*A-k*l,a[1]=c*l-h*A,a[2]=h*k-c*f,a[3]=k*e-g*A,a[4]=d*A-c*e,a[5]=c*g-d*k,a[6]=g*l-f*e,a[7]=h*e-d*l,a[8]=d*f-h*g,a},determinant:function(a){var b=a[3],d=a[4],h=a[5],c=a[6],g=a[7],f=a[8];return a[0]*(f*d-h*g)+a[1]*(-f*b+h*c)+a[2]*(g*b-d*c)},multiply:function(a,b,d){var h=b[0],c=b[1],g=b[2],f=b[3],k=b[4],e=b[5],l=b[6],A=b[7];b=b[8];var u=d[0],n=d[1],v=d[2],
m=d[3],r=d[4],p=d[5],I=d[6],q=d[7];d=d[8];return a[0]=u*h+n*f+v*l,a[1]=u*c+n*k+v*A,a[2]=u*g+n*e+v*b,a[3]=m*h+r*f+p*l,a[4]=m*c+r*k+p*A,a[5]=m*g+r*e+p*b,a[6]=I*h+q*f+d*l,a[7]=I*c+q*k+d*A,a[8]=I*g+q*e+d*b,a}};x.mul=x.multiply;x.translate=function(a,b,d){var h=b[0],c=b[1],g=b[2],f=b[3],k=b[4],e=b[5],l=b[6],A=b[7];b=b[8];var u=d[0];d=d[1];return a[0]=h,a[1]=c,a[2]=g,a[3]=f,a[4]=k,a[5]=e,a[6]=u*h+d*f+l,a[7]=u*c+d*k+A,a[8]=u*g+d*e+b,a};x.rotate=function(a,b,d){var h=b[0],c=b[1],g=b[2],f=b[3],k=b[4],e=b[5],
l=b[6],A=b[7];b=b[8];var u=Math.sin(d);d=Math.cos(d);return a[0]=d*h+u*f,a[1]=d*c+u*k,a[2]=d*g+u*e,a[3]=d*f-u*h,a[4]=d*k-u*c,a[5]=d*e-u*g,a[6]=l,a[7]=A,a[8]=b,a};x.scale=function(a,b,d){var h=d[0];d=d[1];return a[0]=h*b[0],a[1]=h*b[1],a[2]=h*b[2],a[3]=d*b[3],a[4]=d*b[4],a[5]=d*b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a};x.fromMat2d=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=0,a[3]=b[2],a[4]=b[3],a[5]=0,a[6]=b[4],a[7]=b[5],a[8]=1,a};x.fromQuat=function(a,b){var d=b[0],h=b[1],c=b[2],g=b[3],f=d+d,k=h+h,
e=c+c,d=d*f,l=h*f,h=h*k,A=c*f,u=c*k,c=c*e,f=g*f,k=g*k,g=g*e;return a[0]=1-h-c,a[3]=l-g,a[6]=A+k,a[1]=l+g,a[4]=1-d-c,a[7]=u-f,a[2]=A-k,a[5]=u+f,a[8]=1-d-h,a};x.normalFromMat4=function(a,b){var d=b[0],h=b[1],c=b[2],g=b[3],f=b[4],k=b[5],e=b[6],l=b[7],A=b[8],u=b[9],n=b[10],v=b[11],m=b[12],r=b[13],p=b[14],q=b[15],s=d*k-h*f,y=d*e-c*f,z=d*l-g*f,B=h*e-c*k,w=h*l-g*k,x=c*l-g*e,E=A*r-u*m,F=A*p-n*m,A=A*q-v*m,G=u*p-n*r,u=u*q-v*r,n=n*q-v*p;return(v=s*n-y*u+z*G+B*A-w*F+x*E)?(v=1/v,a[0]=(k*n-e*u+l*G)*v,a[1]=(e*A-
f*n-l*F)*v,a[2]=(f*u-k*A+l*E)*v,a[3]=(c*u-h*n-g*G)*v,a[4]=(d*n-c*A+g*F)*v,a[5]=(h*A-d*u-g*E)*v,a[6]=(r*x-p*w+q*B)*v,a[7]=(p*z-m*x-q*y)*v,a[8]=(m*w-r*z+q*s)*v,a):null};x.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};x.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!=typeof c&&
(c.mat3=x);var w={create:function(){var a=new k(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},clone:function(a){var b=new k(16);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],
a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},identity:function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},transpose:function(a,b){if(a===b){var d=b[1],h=b[2],c=b[3],g=b[6],f=b[7],k=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=d;a[6]=b[9];a[7]=b[13];a[8]=h;a[9]=g;a[11]=b[14];a[12]=c;a[13]=f;a[14]=k}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=
b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a},invert:function(a,b){var d=b[0],h=b[1],c=b[2],g=b[3],f=b[4],k=b[5],e=b[6],l=b[7],n=b[8],u=b[9],m=b[10],v=b[11],r=b[12],p=b[13],q=b[14],s=b[15],w=d*k-h*f,y=d*e-c*f,z=d*l-g*f,B=h*e-c*k,x=h*l-g*k,J=c*l-g*e,E=n*p-u*r,F=n*q-m*r,G=n*s-v*r,K=u*q-m*p,L=u*s-v*p,M=m*s-v*q,D=w*M-y*L+z*K+B*G-x*F+J*E;return D?(D=1/D,a[0]=(k*M-e*L+l*K)*D,a[1]=(c*L-h*M-g*K)*D,a[2]=(p*J-q*x+s*B)*D,a[3]=(m*x-u*J-v*B)*
D,a[4]=(e*G-f*M-l*F)*D,a[5]=(d*M-c*G+g*F)*D,a[6]=(q*z-r*J-s*y)*D,a[7]=(n*J-m*z+v*y)*D,a[8]=(f*L-k*G+l*E)*D,a[9]=(h*G-d*L-g*E)*D,a[10]=(r*x-p*z+s*w)*D,a[11]=(u*z-n*x-v*w)*D,a[12]=(k*F-f*K-e*E)*D,a[13]=(d*K-h*F+c*E)*D,a[14]=(p*y-r*B-q*w)*D,a[15]=(n*B-u*y+m*w)*D,a):null},adjoint:function(a,b){var d=b[0],h=b[1],c=b[2],g=b[3],f=b[4],k=b[5],e=b[6],l=b[7],n=b[8],u=b[9],m=b[10],v=b[11],r=b[12],p=b[13],q=b[14],s=b[15];return a[0]=k*(m*s-v*q)-u*(e*s-l*q)+p*(e*v-l*m),a[1]=-(h*(m*s-v*q)-u*(c*s-g*q)+p*(c*v-g*
m)),a[2]=h*(e*s-l*q)-k*(c*s-g*q)+p*(c*l-g*e),a[3]=-(h*(e*v-l*m)-k*(c*v-g*m)+u*(c*l-g*e)),a[4]=-(f*(m*s-v*q)-n*(e*s-l*q)+r*(e*v-l*m)),a[5]=d*(m*s-v*q)-n*(c*s-g*q)+r*(c*v-g*m),a[6]=-(d*(e*s-l*q)-f*(c*s-g*q)+r*(c*l-g*e)),a[7]=d*(e*v-l*m)-f*(c*v-g*m)+n*(c*l-g*e),a[8]=f*(u*s-v*p)-n*(k*s-l*p)+r*(k*v-l*u),a[9]=-(d*(u*s-v*p)-n*(h*s-g*p)+r*(h*v-g*u)),a[10]=d*(k*s-l*p)-f*(h*s-g*p)+r*(h*l-g*k),a[11]=-(d*(k*v-l*u)-f*(h*v-g*u)+n*(h*l-g*k)),a[12]=-(f*(u*q-m*p)-n*(k*q-e*p)+r*(k*m-e*u)),a[13]=d*(u*q-m*p)-n*(h*q-
c*p)+r*(h*m-c*u),a[14]=-(d*(k*q-e*p)-f*(h*q-c*p)+r*(h*e-c*k)),a[15]=d*(k*m-e*u)-f*(h*m-c*u)+n*(h*e-c*k),a},determinant:function(a){var b=a[0],d=a[1],h=a[2],c=a[3],g=a[4],f=a[5],k=a[6],e=a[7],l=a[8],m=a[9],n=a[10],p=a[11],v=a[12],r=a[13],q=a[14];a=a[15];return(b*f-d*g)*(n*a-p*q)-(b*k-h*g)*(m*a-p*r)+(b*e-c*g)*(m*q-n*r)+(d*k-h*f)*(l*a-p*v)-(d*e-c*f)*(l*q-n*v)+(h*e-c*k)*(l*r-m*v)},multiply:function(a,b,d){var h=b[0],c=b[1],g=b[2],f=b[3],k=b[4],e=b[5],l=b[6],m=b[7],n=b[8],p=b[9],r=b[10],q=b[11],s=b[12],
w=b[13],x=b[14];b=b[15];var C=d[0],y=d[1],z=d[2],B=d[3];return a[0]=C*h+y*k+z*n+B*s,a[1]=C*c+y*e+z*p+B*w,a[2]=C*g+y*l+z*r+B*x,a[3]=C*f+y*m+z*q+B*b,C=d[4],y=d[5],z=d[6],B=d[7],a[4]=C*h+y*k+z*n+B*s,a[5]=C*c+y*e+z*p+B*w,a[6]=C*g+y*l+z*r+B*x,a[7]=C*f+y*m+z*q+B*b,C=d[8],y=d[9],z=d[10],B=d[11],a[8]=C*h+y*k+z*n+B*s,a[9]=C*c+y*e+z*p+B*w,a[10]=C*g+y*l+z*r+B*x,a[11]=C*f+y*m+z*q+B*b,C=d[12],y=d[13],z=d[14],B=d[15],a[12]=C*h+y*k+z*n+B*s,a[13]=C*c+y*e+z*p+B*w,a[14]=C*g+y*l+z*r+B*x,a[15]=C*f+y*m+z*q+B*b,a}};w.mul=
w.multiply;w.translate=function(a,b,d){var h=d[0],c=d[1];d=d[2];var g,f,k,e,l,m,n,p,r,q,s,w;return b===a?(a[12]=b[0]*h+b[4]*c+b[8]*d+b[12],a[13]=b[1]*h+b[5]*c+b[9]*d+b[13],a[14]=b[2]*h+b[6]*c+b[10]*d+b[14],a[15]=b[3]*h+b[7]*c+b[11]*d+b[15]):(g=b[0],f=b[1],k=b[2],e=b[3],l=b[4],m=b[5],n=b[6],p=b[7],r=b[8],q=b[9],s=b[10],w=b[11],a[0]=g,a[1]=f,a[2]=k,a[3]=e,a[4]=l,a[5]=m,a[6]=n,a[7]=p,a[8]=r,a[9]=q,a[10]=s,a[11]=w,a[12]=g*h+l*c+r*d+b[12],a[13]=f*h+m*c+q*d+b[13],a[14]=k*h+n*c+s*d+b[14],a[15]=e*h+p*c+w*
d+b[15]),a};w.scale=function(a,b,d){var h=d[0],c=d[1];d=d[2];return a[0]=b[0]*h,a[1]=b[1]*h,a[2]=b[2]*h,a[3]=b[3]*h,a[4]=b[4]*c,a[5]=b[5]*c,a[6]=b[6]*c,a[7]=b[7]*c,a[8]=b[8]*d,a[9]=b[9]*d,a[10]=b[10]*d,a[11]=b[11]*d,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a};w.rotate=function(a,b,d,h){var c=h[0],g=h[1];h=h[2];var k=Math.sqrt(c*c+g*g+h*h),e,l,m,n,p,r,q,s,w,x,I,C,y,z,B,O,J,E,F,G,K,L,M,D;return Math.abs(k)<f?null:(k=1/k,c*=k,g*=k,h*=k,e=Math.sin(d),l=Math.cos(d),m=1-l,n=b[0],p=b[1],r=b[2],q=
b[3],s=b[4],w=b[5],x=b[6],I=b[7],C=b[8],y=b[9],z=b[10],B=b[11],O=c*c*m+l,J=g*c*m+h*e,E=h*c*m-g*e,F=c*g*m-h*e,G=g*g*m+l,K=h*g*m+c*e,L=c*h*m+g*e,M=g*h*m-c*e,D=h*h*m+l,a[0]=n*O+s*J+C*E,a[1]=p*O+w*J+y*E,a[2]=r*O+x*J+z*E,a[3]=q*O+I*J+B*E,a[4]=n*F+s*G+C*K,a[5]=p*F+w*G+y*K,a[6]=r*F+x*G+z*K,a[7]=q*F+I*G+B*K,a[8]=n*L+s*M+C*D,a[9]=p*L+w*M+y*D,a[10]=r*L+x*M+z*D,a[11]=q*L+I*M+B*D,b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a)};w.rotateX=function(a,b,d){var c=Math.sin(d);d=Math.cos(d);var g=b[4],
f=b[5],k=b[6],e=b[7],l=b[8],m=b[9],n=b[10],p=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=g*d+l*c,a[5]=f*d+m*c,a[6]=k*d+n*c,a[7]=e*d+p*c,a[8]=l*d-g*c,a[9]=m*d-f*c,a[10]=n*d-k*c,a[11]=p*d-e*c,a};w.rotateY=function(a,b,d){var c=Math.sin(d);d=Math.cos(d);var g=b[0],f=b[1],k=b[2],e=b[3],l=b[8],m=b[9],n=b[10],p=b[11];return b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=g*d-l*c,
a[1]=f*d-m*c,a[2]=k*d-n*c,a[3]=e*d-p*c,a[8]=g*c+l*d,a[9]=f*c+m*d,a[10]=k*c+n*d,a[11]=e*c+p*d,a};w.rotateZ=function(a,b,d){var c=Math.sin(d);d=Math.cos(d);var g=b[0],f=b[1],k=b[2],e=b[3],l=b[4],m=b[5],n=b[6],p=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=g*d+l*c,a[1]=f*d+m*c,a[2]=k*d+n*c,a[3]=e*d+p*c,a[4]=l*d-g*c,a[5]=m*d-f*c,a[6]=n*d-k*c,a[7]=p*d-e*c,a};w.fromRotationTranslation=function(a,b,d){var c=b[0],g=b[1],f=b[2],k=b[3],
e=c+c,l=g+g,m=f+f;b=c*e;var n=c*l,c=c*m,p=g*l,g=g*m,f=f*m,e=k*e,l=k*l,k=k*m;return a[0]=1-(p+f),a[1]=n+k,a[2]=c-l,a[3]=0,a[4]=n-k,a[5]=1-(b+f),a[6]=g+e,a[7]=0,a[8]=c+l,a[9]=g-e,a[10]=1-(b+p),a[11]=0,a[12]=d[0],a[13]=d[1],a[14]=d[2],a[15]=1,a};w.fromQuat=function(a,b){var d=b[0],c=b[1],g=b[2],f=b[3],k=d+d,e=c+c,l=g+g,d=d*k,m=c*k,c=c*e,n=g*k,p=g*e,g=g*l,k=f*k,e=f*e,f=f*l;return a[0]=1-c-g,a[1]=m+f,a[2]=n-e,a[3]=0,a[4]=m-f,a[5]=1-d-g,a[6]=p+k,a[7]=0,a[8]=n+e,a[9]=p-k,a[10]=1-d-c,a[11]=0,a[12]=0,a[13]=
0,a[14]=0,a[15]=1,a};w.frustum=function(a,b,d,c,g,f,k){var e=1/(d-b),l=1/(g-c),m=1/(f-k);return a[0]=2*f*e,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*f*l,a[6]=0,a[7]=0,a[8]=(d+b)*e,a[9]=(g+c)*l,a[10]=(k+f)*m,a[11]=-1,a[12]=0,a[13]=0,a[14]=k*f*2*m,a[15]=0,a};w.perspective=function(a,b,d,c,g){b=1/Math.tan(b/2);var f=1/(c-g);return a[0]=b/d,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(g+c)*f,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*g*c*f,a[15]=0,a};w.ortho=function(a,b,d,c,g,f,k){var e=1/(b-
d),l=1/(c-g),m=1/(f-k);return a[0]=-2*e,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*l,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*m,a[11]=0,a[12]=(b+d)*e,a[13]=(g+c)*l,a[14]=(k+f)*m,a[15]=1,a};w.lookAt=function(a,b,d,c){var g,k,e,l,m,n,p,r,q,s,x=b[0],N=b[1];b=b[2];var P=c[0],I=c[1];c=c[2];var C=d[0],y=d[1];d=d[2];return Math.abs(x-C)<f&&Math.abs(N-y)<f&&Math.abs(b-d)<f?w.identity(a):(p=x-C,r=N-y,q=b-d,s=1/Math.sqrt(p*p+r*r+q*q),p*=s,r*=s,q*=s,g=I*q-c*r,k=c*p-P*q,e=P*r-I*p,s=Math.sqrt(g*g+k*k+e*e),s?(s=1/s,g*=s,k*=
s,e*=s):(g=0,k=0,e=0),l=r*e-q*k,m=q*g-p*e,n=p*k-r*g,s=Math.sqrt(l*l+m*m+n*n),s?(s=1/s,l*=s,m*=s,n*=s):(l=0,m=0,n=0),a[0]=g,a[1]=l,a[2]=p,a[3]=0,a[4]=k,a[5]=m,a[6]=r,a[7]=0,a[8]=e,a[9]=n,a[10]=q,a[11]=0,a[12]=-(g*x+k*N+e*b),a[13]=-(l*x+m*N+n*b),a[14]=-(p*x+r*N+q*b),a[15]=1,a)};w.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};w.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!=typeof c&&(c.mat4=w);var q={create:function(){var a=new k(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}};q.rotationTo=function(){var a=n.create(),b=n.fromValues(1,0,0),d=n.fromValues(0,1,0);return function(c,g,
f){var k=n.dot(g,f);return-0.999999>k?(n.cross(a,b,g),1E-6>n.length(a)&&n.cross(a,d,g),n.normalize(a,a),q.setAxisAngle(c,a,Math.PI),c):0.999999<k?(c[0]=0,c[1]=0,c[2]=0,c[3]=1,c):(n.cross(a,g,f),c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=1+k,q.normalize(c,c))}}();q.setAxes=function(){var a=x.create();return function(b,d,c,g){return a[0]=c[0],a[3]=c[1],a[6]=c[2],a[1]=g[0],a[4]=g[1],a[7]=g[2],a[2]=-d[0],a[5]=-d[1],a[8]=-d[2],q.normalize(b,q.fromMat3(b,a))}}();q.clone=p.clone;q.fromValues=p.fromValues;q.copy=
p.copy;q.set=p.set;q.identity=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a};q.setAxisAngle=function(a,b,d){d*=0.5;var c=Math.sin(d);return a[0]=c*b[0],a[1]=c*b[1],a[2]=c*b[2],a[3]=Math.cos(d),a};q.add=p.add;q.multiply=function(a,b,d){var c=b[0],g=b[1],f=b[2];b=b[3];var k=d[0],e=d[1],l=d[2];d=d[3];return a[0]=c*d+b*k+g*l-f*e,a[1]=g*d+b*e+f*k-c*l,a[2]=f*d+b*l+c*e-g*k,a[3]=b*d-c*k-g*e-f*l,a};q.mul=q.multiply;q.scale=p.scale;q.rotateX=function(a,b,d){d*=0.5;var c=b[0],g=b[1],f=b[2];b=b[3];var k=Math.sin(d);
d=Math.cos(d);return a[0]=c*d+b*k,a[1]=g*d+f*k,a[2]=f*d-g*k,a[3]=b*d-c*k,a};q.rotateY=function(a,b,d){d*=0.5;var c=b[0],g=b[1],f=b[2];b=b[3];var k=Math.sin(d);d=Math.cos(d);return a[0]=c*d-f*k,a[1]=g*d+b*k,a[2]=f*d+c*k,a[3]=b*d-g*k,a};q.rotateZ=function(a,b,d){d*=0.5;var c=b[0],g=b[1],f=b[2];b=b[3];var k=Math.sin(d);d=Math.cos(d);return a[0]=c*d+g*k,a[1]=g*d-c*k,a[2]=f*d+b*k,a[3]=b*d-f*k,a};q.calculateW=function(a,b){var d=b[0],c=b[1],g=b[2];return a[0]=d,a[1]=c,a[2]=g,a[3]=-Math.sqrt(Math.abs(1-
d*d-c*c-g*g)),a};q.dot=p.dot;q.lerp=p.lerp;q.slerp=function(a,b,d,c){var g=b[0],f=b[1],k=b[2];b=b[3];var e=d[0],l=d[1],m=d[2];d=d[3];var n,p,r,q,s;return p=g*e+f*l+k*m+b*d,0>p&&(p=-p,e=-e,l=-l,m=-m,d=-d),1E-6<1-p?(n=Math.acos(p),r=Math.sin(n),q=Math.sin((1-c)*n)/r,s=Math.sin(c*n)/r):(q=1-c,s=c),a[0]=q*g+s*e,a[1]=q*f+s*l,a[2]=q*k+s*m,a[3]=q*b+s*d,a};q.invert=function(a,b){var d=b[0],c=b[1],g=b[2],f=b[3],k=d*d+c*c+g*g+f*f,k=k?1/k:0;return a[0]=-d*k,a[1]=-c*k,a[2]=-g*k,a[3]=f*k,a};q.conjugate=function(a,
b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=b[3],a};q.length=p.length;q.len=q.length;q.squaredLength=p.squaredLength;q.sqrLen=q.squaredLength;q.normalize=p.normalize;q.fromMat3=function(a,b){var d=b[0]+b[4]+b[8];if(0<d)d=Math.sqrt(d+1),a[3]=0.5*d,d=0.5/d,a[0]=(b[7]-b[5])*d,a[1]=(b[2]-b[6])*d,a[2]=(b[3]-b[1])*d;else{var c=0;b[4]>b[0]&&(c=1);b[8]>b[3*c+c]&&(c=2);var g=(c+1)%3,f=(c+2)%3,d=Math.sqrt(b[3*c+c]-b[3*g+g]-b[3*f+f]+1);a[c]=0.5*d;d=0.5/d;a[3]=(b[3*f+g]-b[3*g+f])*d;a[g]=(b[3*g+c]+b[3*c+g])*
d;a[f]=(b[3*f+c]+b[3*c+f])*d}return a};q.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!=typeof c&&(c.quat=q)})(e)})(this);bongiovi=window.bongiovi||{};
(function(){SimpleImageLoader=function(){this._imgs={};this._toLoadCount=this._loadedCount=0;this._callbackProgress=this._callback=this._scope=void 0};var c=SimpleImageLoader.prototype;c.load=function(c,g,f,k){this._imgs={};this._loadedCount=0;this._toLoadCount=c.length;this._scope=g;this._callback=f;this._callbackProgress=k;var l=this;for(g=0;g<c.length;g++){f=new Image;f.onload=function(){l._onImageLoaded()};k=c[g];var m=k.split("/"),m=m[m.length-1].split(".")[0];this._imgs[m]=f;f.src=k}};c._onImageLoaded=
function(){this._loadedCount++;if(this._loadedCount==this._toLoadCount)this._callback.call(this._scope,this._imgs);else{var c=this._loadedCount/this._toLoadCount;this._callbackProgress&&this._callbackProgress.call(this._scope,c)}}})();bongiovi.SimpleImageLoader=new SimpleImageLoader;bongiovi.Utils={};
(function(){var c=function(c,f){this._easing=f||0.1;this._targetValue=this._value=c;bongiovi.Scheduler.addEF(this,this._update)},e=c.prototype;e._update=function(){this._checkLimit();this._value+=(this._targetValue-this._value)*this._easing};e.setTo=function(c){this._targetValue=this._value=c};e.add=function(c){this._targetValue+=c};e.limit=function(c,f){this._min=c;this._max=f;this._checkLimit()};e._checkLimit=function(){void 0!=this._min&&this._targetValue<this._min&&(this._targetValue=this._min);
void 0!=this._max&&this._targetValue>this._max&&(this._targetValue=this._max)};e.__defineGetter__("value",function(){return this._value});e.__defineGetter__("targetValue",function(){return this._targetValue});e.__defineSetter__("value",function(c){this._targetValue=c});bongiovi.EaseNumber=c})();bongiovi=window.bongiovi||{};void 0==window.requestAnimFrame&&(window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){window.setTimeout(c,1E3/60)}}());
(function(){var c=function(){this.FRAMERATE=60;this._delayTasks=[];this._nextTasks=[];this._deferTasks=[];this._highTasks=[];this._usurpTask=[];this._enterframeTasks=[];this._idTable=0;requestAnimFrame(this._loop.bind(this))},e=c.prototype;e._loop=function(){requestAnimFrame(this._loop.bind(this));this._process()};e._process=function(){for(var c=0;c<this._enterframeTasks.length;c++){var f=this._enterframeTasks[c];null!=f&&void 0!=f&&f.func.apply(f.scope,f.params)}for(;0<this._highTasks.length;)f=
this._highTasks.pop(),f.func.apply(f.scope,f.params);for(var k=(new Date).getTime(),c=0;c<this._delayTasks.length;c++)f=this._delayTasks[c],k-f.time>f.delay&&(f.func.apply(f.scope,f.params),this._delayTasks.splice(c,1));k=(new Date).getTime();for(c=1E3/this.FRAMERATE;0<this._deferTasks.length;){var f=this._deferTasks.shift(),e=(new Date).getTime();if(e-k<c)f.func.apply(f.scope,f.params);else{this._deferTasks.unshift(f);break}}k=(new Date).getTime();for(c=1E3/this.FRAMERATE;0<this._usurpTask.length;)if(f=
this._usurpTask.shift(),e=(new Date).getTime(),e-k<c)f.func.apply(f.scope,f.params);else break;this._highTasks=this._highTasks.concat(this._nextTasks);this._nextTasks=[];this._usurpTask=[]};e.addEF=function(c,f,k){k=k||[];var e=this._idTable;this._enterframeTasks[e]={scope:c,func:f,params:k};this._idTable++;return e};e.removeEF=function(c){void 0!=this._enterframeTasks[c]&&(this._enterframeTasks[c]=null);return-1};e.delay=function(c,f,k,e){var m=(new Date).getTime();this._delayTasks.push({scope:c,
func:f,params:k,delay:e,time:m})};e.defer=function(c,f,k){this._deferTasks.push({scope:c,func:f,params:k})};e.next=function(c,f,k){this._nextTasks.push({scope:c,func:f,params:k})};e.usurp=function(c,f,k){this._usurpTask.push({scope:c,func:f,params:k})};bongiovi.Scheduler=new c})();bongiovi=window.bongiovi||{};
(function(){var c=null,e=function(){this.aspectRatio=window.innerWidth/window.innerHeight;this.fieldOfView=45;this.zNear=5;this.zFar=3E3;this.gl=this.canvas=null;this.H=this.W=0;this.shaderProgram=this.shader=null},g=e.prototype;g.init=function(c){this.canvas=c;this.gl=this.canvas.getContext("experimental-webgl",{antialias:!0});this.resize();this.gl.getParameter(this.gl.SAMPLES);this.gl.getContextAttributes();this.gl.viewport(0,0,this.gl.viewportWidth,this.gl.viewportHeight);this.gl.enable(this.gl.DEPTH_TEST);
this.gl.enable(this.gl.CULL_FACE);this.gl.enable(this.gl.BLEND);this.gl.clearColor(0,0,0,1);this.gl.clearDepth(1);this.matrix=mat4.create();mat4.identity(this.matrix);this.depthTextureExt=this.gl.getExtension("WEBKIT_WEBGL_depth_texture");this.floatTextureExt=this.gl.getExtension("OES_texture_float");this.enableAlphaBlending();var g=this;window.addEventListener("resize",function(){g.resize()})};g.getGL=function(){return this.gl};g.setShader=function(c){this.shader=c};g.setShaderProgram=function(c){this.shaderProgram=
c};g.setViewport=function(c,g,e,m){this.gl.viewport(c,g,e,m)};g.setMatrices=function(c){this.camera=c};g.rotate=function(c){mat4.copy(this.matrix,c)};g.render=function(){null!=this.shaderProgram&&(this.setViewport(0,0,this.W,this.H),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA))};g.enableAlphaBlending=function(){this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)};g.enableAdditiveBlending=function(){this.gl.blendFunc(this.gl.ONE,
this.gl.ONE)};g.clear=function(c,g,e,m){this.gl.clearColor(c,g,e,m);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)};g.draw=function(c){function g(c,f,k){void 0==f.cacheAttribLoc&&(f.cacheAttribLoc={});void 0==f.cacheAttribLoc[k]&&(f.cacheAttribLoc[k]=c.getAttribLocation(f,k));return f.cacheAttribLoc[k]}if(this.shaderProgram){this.gl.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.camera.getMatrix());this.gl.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.matrix);
this.gl.bindBuffer(this.gl.ARRAY_BUFFER,c.vBufferPos);var e=g(this.gl,this.shaderProgram,"aVertexPosition");this.gl.vertexAttribPointer(e,c.vBufferPos.itemSize,this.gl.FLOAT,!1,0,0);this.gl.enableVertexAttribArray(e);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,c.vBufferUV);e=g(this.gl,this.shaderProgram,"aTextureCoord");this.gl.vertexAttribPointer(e,c.vBufferUV.itemSize,this.gl.FLOAT,!1,0,0);this.gl.enableVertexAttribArray(e);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,c.iBuffer);for(e=0;e<c.extraAttributes.length;e++){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,
c.extraAttributes[e].buffer);var m=g(this.gl,this.shaderProgram,c.extraAttributes[e].name);this.gl.vertexAttribPointer(m,c.extraAttributes[e].itemSize,this.gl.FLOAT,!1,0,0);this.gl.enableVertexAttribArray(m)}c.drawType==this.gl.POINTS?this.gl.drawArrays(c.drawType,0,c.vertexSize):this.gl.drawElements(c.drawType,c.iBuffer.numItems,this.gl.UNSIGNED_SHORT,0)}else console.warn("Shader program not ready yet")};g.resize=function(){this.W=window.innerWidth;this.H=window.innerHeight;this.canvas.width=this.W;
this.canvas.height=this.H;this.gl.viewportWidth=this.W;this.gl.viewportHeight=this.H;this.gl.viewport(0,0,this.W,this.H);this.aspectRatio=window.innerWidth/window.innerHeight;this.render()};e.getInstance=function(){null==c&&(c=new e);return c};bongiovi.GL=e.getInstance();bongiovi.GLTool=e.getInstance()})();bongiovi=window.bongiovi||{};
(function(){var c=function(c){void 0==c&&(c=document);this._isRotateZ=0;this.matrix=mat4.create();this.m=mat4.create();this._vZaxis=vec3.clone([0,0,0]);this._zAxis=vec3.clone([0,0,-1]);this.preMouse={x:0,y:0};this.mouse={x:0,y:0};this._isMouseDown=!1;this._rotation=quat.clone([0,0,1,0]);this.tempRotation=quat.clone([0,0,0,0]);this._currDiffY=this._currDiffX=this.diffY=this.diffX=this._rotateZMargin=0;this._offset=0.0040;this._easing=0.1;this._slerp=-1;this._isLocked=!1;var f=this;c.addEventListener("mousedown",
function(c){f._onMouseDown(c)});c.addEventListener("touchstart",function(c){f._onMouseDown(c)});c.addEventListener("mouseup",function(c){f._onMouseUp(c)});c.addEventListener("touchend",function(c){f._onMouseUp(c)});c.addEventListener("mousemove",function(c){f._onMouseMove(c)});c.addEventListener("touchmove",function(c){f._onMouseMove(c)})},e=c.prototype;e.inverseControl=function(c){this._isInvert=void 0==c?!0:c};e.lock=function(c){this._isLocked=void 0==c?!0:c};e.getMousePos=function(c){var f;void 0!=
c.changedTouches?(f=c.changedTouches[0].pageX,c=c.changedTouches[0].pageY):(f=c.clientX,c=c.clientY);return{x:f,y:c}};e._onMouseDown=function(c){if(!this._isLocked&&!this._isMouseDown){c=this.getMousePos(c);var f=quat.clone(this._rotation);this._updateRotation(f);this._rotation=f;this._isMouseDown=!0;this._isRotateZ=0;this.preMouse={x:c.x,y:c.y};if(c.y<this._rotateZMargin||c.y>window.innerHeight-this._rotateZMargin)this._isRotateZ=1;else if(c.x<this._rotateZMargin||c.x>window.innerWidth-this._rotateZMargin)this._isRotateZ=
2;this._currDiffY=this.diffY=this._currDiffX=this.diffX=0}};e._onMouseMove=function(c){this._isLocked||(c.touches&&c.preventDefault(),this.mouse=this.getMousePos(c))};e._onMouseUp=function(c){!this._isLocked&&this._isMouseDown&&(this._isMouseDown=!1)};e.setCameraPos=function(c,f){this._easing=f=f||this._easing;if(!(0<this._slerp)){var e=quat.clone(this._rotation);this._updateRotation(e);this._rotation=quat.clone(e);this._currDiffY=this.diffY=this._currDiffX=this.diffX=0;this._isMouseDown=!1;this._isRotateZ=
0;this._targetQuat=quat.clone(c);this._slerp=1}};e.resetQuat=function(){this._rotation=quat.clone([0,0,1,0]);this.tempRotation=quat.clone([0,0,0,0]);this._targetQuat=void 0;this._slerp=-1};e.update=function(){mat4.identity(this.m);void 0==this._targetQuat?(quat.set(this.tempRotation,this._rotation[0],this._rotation[1],this._rotation[2],this._rotation[3]),this._updateRotation(this.tempRotation)):(this._slerp+=0.1*(0-this._slerp),0.0010>this._slerp?(quat.set(this._rotation,this._targetQuat[0],this._targetQuat[1],
this._targetQuat[2],this._targetQuat[3]),this._targetQuat=void 0,this._slerp=-1):(quat.set(this.tempRotation,0,0,0,0),quat.slerp(this.tempRotation,this._targetQuat,this._rotation,this._slerp)));vec3.transformQuat(this._vZaxis,this._vZaxis,this.tempRotation);mat4.fromQuat(this.matrix,this.tempRotation)};e._updateRotation=function(c){this._isMouseDown&&!this._isLocked&&(this.diffX=-(this.mouse.x-this.preMouse.x),this.diffY=this.mouse.y-this.preMouse.y,this._isInvert&&(this.diffX=-this.diffX),this._isInvert&&
(this.diffY=-this.diffY));this._currDiffX+=(this.diffX-this._currDiffX)*this._easing;this._currDiffY+=(this.diffY-this._currDiffY)*this._easing;if(0<this._isRotateZ){if(1==this._isRotateZ)var f=-this._currDiffX*this._offset,f=f*(this.preMouse.y<this._rotateZMargin?-1:1),e=quat.clone([0,0,Math.sin(f),Math.cos(f)]);else f=-this._currDiffY*this._offset,f*=this.preMouse.x<this._rotateZMargin?1:-1,e=quat.clone([0,0,Math.sin(f),Math.cos(f)]);quat.multiply(quat,c,e)}else f=vec3.clone([this._currDiffX,this._currDiffY,
0]),e=vec3.create(),vec3.cross(e,f,this._zAxis),vec3.normalize(e,e),f=vec3.length(f)*this._offset,e=quat.clone([Math.sin(f)*e[0],Math.sin(f)*e[1],Math.sin(f)*e[2],Math.cos(f)]),quat.multiply(c,e,c)};bongiovi.SceneRotation=c})();(function(){var c=function(){this.gl=bongiovi.GLTool.gl;this._children=[];this._init()},e=c.prototype;e._init=function(){this.camera=new bongiovi.SimpleCamera;this.camera.setPerspective(45*Math.PI/180,window.innerWidth/window.innerHeight,5,3E3);this.camera.lockRotation();var c=vec3.clone([0,0,500]),f=vec3.create(),e=vec3.clone([0,-1,0]);this.camera.lookAt(c,f,e);this.sceneRotation=new bongiovi.SceneRotation;this.rotationFront=mat4.create();mat4.identity(this.rotationFront);this.cameraOtho=new bongiovi.Camera;
this._initTextures();this._initViews();window.addEventListener("resize",this._onResize.bind(this))};e._initTextures=function(){};e._initViews=function(){};e.loop=function(){this.update();this.render()};e.update=function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.sceneRotation.update();bongiovi.GLTool.setMatrices(this.camera);bongiovi.GLTool.rotate(this.sceneRotation.matrix)};e.render=function(){};e._onResize=function(c){this.camera.resize&&this.camera.resize(window.innerWidth/
window.innerHeight)};bongiovi.Scene=c})();bongiovi=window.bongiovi||{};(function(){var c=function(){this.matrix=mat4.create();mat4.identity(this.matrix);this.position=vec3.create()},e=c.prototype;e.lookAt=function(c,f,e){vec3.copy(this.position,c);mat4.identity(this.matrix);mat4.lookAt(this.matrix,c,f,e)};e.getMatrix=function(){return this.matrix};bongiovi.Camera=c})();bongiovi=window.bongiovi||{};
(function(){var c=bongiovi.Camera,e=function(){c.call(this);this.projection=mat4.create();this.mtxFinal=mat4.create()},g=e.prototype=new c;g.setPerspective=function(c,g,e,m){this._fov=c;this._near=e;this._far=m;mat4.perspective(this.projection,c,g,e,m)};g.getMatrix=function(){mat4.multiply(this.mtxFinal,this.projection,this.matrix);return this.mtxFinal};g.resize=function(c){mat4.perspective(this.projection,this._fov,c,this._near,this._far)};bongiovi.CameraPerspective=e})();(function(){var c=function(c){this._listenerTarget=c||window;bongiovi.CameraPerspective.call(this);this._isLocked=!1;this._init()},e=c.prototype=new bongiovi.CameraPerspective,g=bongiovi.CameraPerspective.prototype,f=bongiovi.EaseNumber;e._init=function(){this.radius=new f(500);this.position[2]=this.radius.value;this.center=vec3.create();this.up=vec3.clone([0,-1,0]);this.lookAt(this.position,this.center,this.up);this._mouse={};this._preMouse={};this._isMouseDown=!1;this._rx=new f(0);this._rx.limit(-Math.PI/
2,Math.PI/2);this._ry=new f(0);this._preRY=this._preRX=0;this._isInvert=this._isLockRotation=this._isLocked=!1;this._listenerTarget.addEventListener("mousewheel",this._onWheel.bind(this));this._listenerTarget.addEventListener("DOMMouseScroll",this._onWheel.bind(this));this._listenerTarget.addEventListener("mousedown",this._onMouseDown.bind(this));this._listenerTarget.addEventListener("touchstart",this._onMouseDown.bind(this));this._listenerTarget.addEventListener("mousemove",this._onMouseMove.bind(this));
this._listenerTarget.addEventListener("touchmove",this._onMouseMove.bind(this));window.addEventListener("mouseup",this._onMouseUp.bind(this));window.addEventListener("touchend",this._onMouseUp.bind(this))};e.inverseControl=function(c){this._isInvert=void 0==c?!0:c};e.lock=function(c){this._isLocked=void 0==c?!0:c};e.lockRotation=function(c){this._isLockRotation=void 0==c?!0:c};e._onMouseDown=function(c){this._isLockRotation||this._isLocked||(this._isMouseDown=!0,k(c,this._mouse),k(c,this._preMouse),
this._preRX=this._rx.targetValue,this._preRY=this._ry.targetValue)};e._onMouseMove=function(c){this._isLockRotation||this._isLocked||(k(c,this._mouse),c.touches&&c.preventDefault(),this._isMouseDown&&(c=this._mouse.x-this._preMouse.x,this._isInvert&&(c*=-1),this._ry.value=this._preRY-0.01*c,c=this._mouse.y-this._preMouse.y,this._isInvert&&(c*=-1),this._rx.value=this._preRX-0.01*c,this._rx.targetValue>0.5*Math.PI&&(this._rx.targetValue=Math)))};e._onMouseUp=function(c){this._isLockRotation||this._isLocked||
(this._isMouseDown=!1)};e._onWheel=function(c){if(!this._isLocked){var g=c.wheelDelta;c=c.detail;this.radius.add(5*-(c?g?0<g/c/40*c?1:-1:-c/3:g/120))}};e.getMatrix=function(){this._updateCameraPosition();this.lookAt(this.position,this.center,this.up);return g.getMatrix.call(this)};e._updateCameraPosition=function(){this.position[2]=this.radius.value;this.position[1]=Math.sin(this._rx.value)*this.radius.value;var c=Math.cos(this._rx.value)*this.radius.value;this.position[0]=Math.cos(this._ry.value+
0.5*Math.PI)*c;this.position[2]=Math.sin(this._ry.value+0.5*Math.PI)*c};var k=function(c,g){var f=g||{};c.touches?(f.x=c.touches[0].pageX,f.y=c.touches[0].pageY):(f.x=c.clientX,f.y=c.clientY);return f};e.__defineGetter__("rx",function(){return this._rx.targetValue});e.__defineSetter__("rx",function(c){this._rx.value=c});e.__defineGetter__("ry",function(){return this._ry.targetValue});e.__defineSetter__("ry",function(c){this._ry.value=c});bongiovi.SimpleCamera=c})();(function(){var c=function(c,f,e){this.gl=bongiovi.GLTool.gl;this.vertexSize=c;this.indexSize=f;this.drawType=e;this.extraAttributes=[];this._floatArrayVertex=this.vBufferPos=void 0;this._init()},e=c.prototype;e._init=function(){};e.bufferVertex=function(c,f){for(var e=[],l=f?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW,m=0;m<c.length;m++)for(var s=0;s<c[m].length;s++)e.push(c[m][s]);void 0==this.vBufferPos&&(this.vBufferPos=this.gl.createBuffer());this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vBufferPos);
if(void 0==this._floatArrayVertex)this._floatArrayVertex=new Float32Array(e);else if(c.length!=this._floatArrayVertex.length)this._floatArrayVertex=new Float32Array(e);else for(m=0;m<c.length;m++)this._floatArrayVertex[m]=c[m];this.gl.bufferData(this.gl.ARRAY_BUFFER,this._floatArrayVertex,l);this.vBufferPos.itemSize=3};e.bufferTexCoords=function(c){for(var f=[],e=0;e<c.length;e++)for(var l=0;l<c[e].length;l++)f.push(c[e][l]);this.vBufferUV=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,
this.vBufferUV);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(f),this.gl.STATIC_DRAW);this.vBufferUV.itemSize=2};e.bufferData=function(c,e,k,l){var m=-1;l=l?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW;for(var s=0;s<this.extraAttributes.length;s++)if(this.extraAttributes[s].name==e){this.extraAttributes[s].data=c;m=s;break}for(var r=[],s=0;s<c.length;s++)for(var n=0;n<c[s].length;n++)r.push(c[s][n]);if(-1==m)s=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s),m=new Float32Array(r),
this.gl.bufferData(this.gl.ARRAY_BUFFER,m,l),this.extraAttributes.push({name:e,data:c,itemSize:k,buffer:s,floatArray:m});else{s=this.extraAttributes[m].buffer;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s);m=this.extraAttributes[m].floatArray;for(s=0;s<r.length;s++)m[s]=r[s];this.gl.bufferData(this.gl.ARRAY_BUFFER,m,l)}};e.bufferIndices=function(c){this.iBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.iBuffer);this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(c),
this.gl.STATIC_DRAW);this.iBuffer.itemSize=1;this.iBuffer.numItems=c.length};bongiovi.Mesh=c})();(function(){var c=function(c,e){this.gl=bongiovi.GL.gl;this.idVertex=c;this.idFragment=e;this.parameters=[];this.uniformTextures=[];this.fragmentShader=this.vertexShader=void 0;this._isReady=!1;this._loadedCount=0;void 0==c&&this.createVertexShaderProgram("precision highp float;attribute vec3 aVertexPosition;attribute vec2 aTextureCoord;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;varying vec2 vTextureCoord;void main(void) {    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);    vTextureCoord = aTextureCoord;}");
void 0==e&&this.createFragmentShaderProgram("precision mediump float;varying vec2 vTextureCoord;uniform sampler2D texture;void main(void) {    gl_FragColor = texture2D(texture, vTextureCoord);}");this.init()};c.defaultVertexShader="precision highp float;attribute vec3 aVertexPosition;attribute vec2 aTextureCoord;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;varying vec2 vTextureCoord;void main(void) {    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);    vTextureCoord = aTextureCoord;}";
c.defaultFragmentShader="precision mediump float;varying vec2 vTextureCoord;uniform sampler2D texture;void main(void) {    gl_FragColor = texture2D(texture, vTextureCoord);}";var e=c.prototype;e.init=function(){this.idVertex&&-1<this.idVertex.indexOf("main(void)")?this.createVertexShaderProgram(this.idVertex):this.getShader(this.idVertex,!0);this.idFragment&&-1<this.idFragment.indexOf("main(void)")?this.createFragmentShaderProgram(this.idFragment):this.getShader(this.idFragment,!1)};e.getShader=function(c,
e){if(c){var k=new XMLHttpRequest;k.hasCompleted=!1;var l=this;k.onreadystatechange=function(c){4==c.target.readyState&&(e?l.createVertexShaderProgram(c.target.responseText):l.createFragmentShaderProgram(c.target.responseText))};k.open("GET",c,!0);k.send(null)}};e.createVertexShaderProgram=function(c){if(this.gl){var e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,c);this.gl.compileShader(e);if(!this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS))return console.warn("Error in Vertex Shader : ",
this.idVertex,":",this.gl.getShaderInfoLog(e)),console.log(c),null;this.vertexShader=e;void 0!=this.vertexShader&&void 0!=this.fragmentShader&&this.attachShaderProgram();this._loadedCount++}};e.createFragmentShaderProgram=function(c){if(this.gl){var e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,c);this.gl.compileShader(e);if(!this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS))return console.warn("Error in Fragment Shader: ",this.idFragment,":",this.gl.getShaderInfoLog(e)),
console.log(c),null;this.fragmentShader=e;void 0!=this.vertexShader&&void 0!=this.fragmentShader&&this.attachShaderProgram();this._loadedCount++}};e.attachShaderProgram=function(){this._isReady=!0;this.shaderProgram=this.gl.createProgram();this.gl.attachShader(this.shaderProgram,this.vertexShader);this.gl.attachShader(this.shaderProgram,this.fragmentShader);this.gl.linkProgram(this.shaderProgram)};e.bind=function(){this._isReady&&(this.gl.useProgram(this.shaderProgram),void 0==this.shaderProgram.pMatrixUniform&&
(this.shaderProgram.pMatrixUniform=this.gl.getUniformLocation(this.shaderProgram,"uPMatrix")),void 0==this.shaderProgram.mvMatrixUniform&&(this.shaderProgram.mvMatrixUniform=this.gl.getUniformLocation(this.shaderProgram,"uMVMatrix")),bongiovi.GLTool.setShader(this),bongiovi.GLTool.setShaderProgram(this.shaderProgram),this.uniformTextures=[])};e.isReady=function(){return this._isReady};e.uniform=function(c,e,k){if(this._isReady){"texture"==e&&(e="uniform1i");for(var l=!1,m,s=0;s<this.parameters.length;s++)if(m=
this.parameters[s],m.name==c){m.value=k;l=!0;break}l?this.shaderProgram[c]=m.uniformLoc:(this.shaderProgram[c]=this.gl.getUniformLocation(this.shaderProgram,c),this.parameters.push({name:c,type:e,value:k,uniformLoc:this.shaderProgram[c]}));if(-1==e.indexOf("Matrix"))this.gl[e](this.shaderProgram[c],k);else this.gl[e](this.shaderProgram[c],!1,k);"uniform1i"==e&&(this.uniformTextures[k]=this.shaderProgram[c])}};e.unbind=function(){};bongiovi.GLShader=c})();(function(){var c,e,g=function(f,g,m){m=m||{};c=bongiovi.GL.gl;e=bongiovi.GL;if(g)this.texture=f;else{this._source=f;this.texture=c.createTexture();this._isVideo="VIDEO"==f.tagName;this.magFilter=m.magFilter||c.LINEAR;this.minFilter=m.minFilter||c.LINEAR_MIPMAP_NEAREST;this.wrapS=m.wrapS||c.MIRRORED_REPEAT;this.wrapT=m.wrapT||c.MIRRORED_REPEAT;g=f.width||f.videoWidth;m=f.height||f.videoHeight;if(g){if(0==g||g&g-1||0==m||m&m-1)this.wrapS=this.wrapT=c.CLAMP_TO_EDGE,this.minFilter==c.LINEAR_MIPMAP_NEAREST&&
(this.minFilter=c.LINEAR),console.log(this.minFilter,c.LINEAR_MIPMAP_NEAREST,c.LINEAR)}else this.wrapS=this.wrapT=c.CLAMP_TO_EDGE,this.minFilter==c.LINEAR_MIPMAP_NEAREST&&(this.minFilter=c.LINEAR);c.bindTexture(c.TEXTURE_2D,this.texture);c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,!0);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,f);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,this.magFilter);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,this.minFilter);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,
this.wrapS);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,this.wrapT);this.minFilter==c.LINEAR_MIPMAP_NEAREST&&c.generateMipmap(c.TEXTURE_2D);c.bindTexture(c.TEXTURE_2D,null)}},f=g.prototype;f.updateTexture=function(e){e&&(this._source=e);c.bindTexture(c.TEXTURE_2D,this.texture);c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,!0);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,this._source);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,this.magFilter);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,
this.minFilter);this.minFilter==c.LINEAR_MIPMAP_NEAREST&&c.generateMipmap(c.TEXTURE_2D);c.bindTexture(c.TEXTURE_2D,null)};f.bind=function(f,g){void 0==f&&(f=0);e.shader&&(c.activeTexture(c.TEXTURE0+f),c.bindTexture(c.TEXTURE_2D,this.texture),c.uniform1i(e.shader.uniformTextures[f],f),this._bindIndex=f)};f.unbind=function(){c.bindTexture(c.TEXTURE_2D,null)};bongiovi.GLTexture=g})();(function(){var c=function(c,e){this.shader=new bongiovi.GLShader(c,e);this._init()},e=c.prototype;e._init=function(){};e.render=function(){};bongiovi.View=c})();(function(){var c=bongiovi.View,e=function(e,g){c.call(this,e,g)},g=e.prototype=new c;g._init=function(){this.mesh=bongiovi.MeshUtils.createPlane(2,2,1)};g.render=function(c){this.shader.isReady()&&(this.shader.bind(),this.shader.uniform("texture","uniform1i",0),c.bind(0),bongiovi.GLTool.draw(this.mesh))};bongiovi.ViewCopy=e})();(function(){var c,e=bongiovi.GLTexture,g=function(e,f,g){c=bongiovi.GLTool.gl;g=g||{};this.width=e;this.height=f;this.magFilter=g.magFilter||c.LINEAR;this.minFilter=g.minFilter||c.LINEAR;this.wrapS=g.wrapS||c.MIRRORED_REPEAT;this.wrapT=g.wrapT||c.MIRRORED_REPEAT;if(0==e||e&e-1||0==f||f&f-1)this.wrapS=this.wrapT=c.CLAMP_TO_EDGE,this.minFilter==c.LINEAR_MIPMAP_NEAREST&&(this.minFilter=c.LINEAR);this._init()},f=g.prototype;f._init=function(){this.depthTextureExt=c.getExtension("WEBKIT_WEBGL_depth_texture");
this.texture=c.createTexture();this.depthTexture=c.createTexture();this.glTexture=new e(this.texture,!0);this.glDepthTexture=new e(this.depthTexture,!0);this.frameBuffer=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,this.frameBuffer);this.frameBuffer.width=this.width;this.frameBuffer.height=this.height;c.bindTexture(c.TEXTURE_2D,this.texture);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,this.magFilter);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,this.minFilter);c.texParameteri(c.TEXTURE_2D,
c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);this.magFilter==c.NEAREST&&this.minFilter==c.NEAREST?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,this.frameBuffer.width,this.frameBuffer.height,0,c.RGBA,c.FLOAT,null):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,this.frameBuffer.width,this.frameBuffer.height,0,c.RGBA,c.UNSIGNED_BYTE,null);this.minFilter==c.LINEAR_MIPMAP_NEAREST&&c.generateMipmap(c.TEXTURE_2D);c.bindTexture(c.TEXTURE_2D,this.depthTexture);c.texParameteri(c.TEXTURE_2D,
c.TEXTURE_MAG_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);null!=this.depthTextureExt&&c.texImage2D(c.TEXTURE_2D,0,c.DEPTH_COMPONENT,this.width,this.height,0,c.DEPTH_COMPONENT,c.UNSIGNED_SHORT,null);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,this.texture,0);if(null==this.depthTextureExt){var f=c.createRenderbuffer();
c.bindRenderbuffer(c.RENDERBUFFER,f);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,this.frameBuffer.width,this.frameBuffer.height);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,f)}else c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.TEXTURE_2D,this.depthTexture,0);c.bindTexture(c.TEXTURE_2D,null);c.bindRenderbuffer(c.RENDERBUFFER,null);c.bindFramebuffer(c.FRAMEBUFFER,null)};f.bind=function(){c.bindFramebuffer(c.FRAMEBUFFER,this.frameBuffer)};f.unbind=
function(){c.bindFramebuffer(c.FRAMEBUFFER,null)};f.getTexture=function(){return this.glTexture};f.getDepthTexture=function(){return this.glDepthTexture};bongiovi.FrameBuffer=g})();(function(){var c,e=function(e,g,l){c=bongiovi.GL;void 0!=e&&(this.view="string"==typeof e?new bongiovi.ViewCopy(null,e):e,this.width=void 0==g?512:g,this.height=void 0==l?512:l,this._init())},g=e.prototype;g._init=function(){this.fbo=new bongiovi.FrameBuffer(this.width,this.height);this.fbo.bind();c.setViewport(0,0,this.fbo.width,this.fbo.height);c.clear(0,0,0,0);this.fbo.unbind();c.setViewport(0,0,c.canvas.width,c.canvas.height)};g.render=function(e){this.fbo.bind();c.setViewport(0,0,this.fbo.width,
this.fbo.height);c.clear(0,0,0,0);this.view.render(e);this.fbo.unbind();c.setViewport(0,0,c.canvas.width,c.canvas.height);return this.fbo.getTexture()};g.getTexture=function(){return this.fbo.getTexture()};bongiovi.Pass=e})();(function(c){c=function(){this._passes=[]};var e=c.prototype=new bongiovi.Pass;e.addPass=function(c){this._passes.push(c)};e.render=function(c){this.texture=c;for(c=0;c<this._passes.length;c++)this.texture=this._passes[c].render(this.texture);return this.texture};e.getTexture=function(){return this.texture};bongiovi.EffectComposer=c})();(function(){bongiovi.MeshUtils={};bongiovi.MeshUtils.createPlane=function(c,e,g){var f=[],k=[],l=[],m=c/g,s=e/g,r=1/g,n=0;c=0.5*-c;e=0.5*-e;for(var p=0;p<g;p++)for(var x=0;x<g;x++){var w=m*p+c,q=s*x+e;f.push([w,q,0]);f.push([w+m,q,0]);f.push([w+m,q+s,0]);f.push([w,q+s,0]);w=p/g;q=x/g;k.push([w,q]);k.push([w+r,q]);k.push([w+r,q+r]);k.push([w,q+r]);l.push(4*n+0);l.push(4*n+1);l.push(4*n+2);l.push(4*n+0);l.push(4*n+2);l.push(4*n+3);n++}g=new bongiovi.Mesh(f.length,l.length,bongiovi.GLTool.gl.TRIANGLES);
g.bufferVertex(f);g.bufferTexCoords(k);g.bufferIndices(l);return g};bongiovi.MeshUtils.createSphere=function(c,e){for(var g=[],f=[],k=[],l=0,m=1/e,s=function(f,g){var a=f/e*Math.PI-0.5*Math.PI,b=g/e*Math.PI*2,d=[];d[1]=Math.sin(a)*c;a=Math.cos(a)*c;d[0]=Math.cos(b)*a;d[2]=Math.sin(b)*a;return d},r=0;r<e;r++)for(var n=0;n<e;n++){g.push(s(r,n));g.push(s(r+1,n));g.push(s(r+1,n+1));g.push(s(r,n+1));var p=n/e,x=r/e;f.push([1-p,x]);f.push([1-p,x+m]);f.push([1-p-m,x+m]);f.push([1-p-m,x]);k.push(4*l+0);k.push(4*
l+1);k.push(4*l+2);k.push(4*l+0);k.push(4*l+2);k.push(4*l+3);l++}l=new bongiovi.Mesh(g.length,k.length,bongiovi.GLTool.gl.TRIANGLES);l.bufferVertex(g);l.bufferTexCoords(f);l.bufferIndices(k);return l};bongiovi.MeshUtils.createCube=function(c,e){}})();
